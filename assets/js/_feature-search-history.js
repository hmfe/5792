"use strict";define(["utilities","storage"],function(e,t){var r="search-history",a={wrapper:".search__history",list:"search__history-list",deleteAll:".search__history-delete--all",deleteItem:"search__history-delete--item"};return{saveHistoryToStorage:function(a){if(a){var i=t.getLocalStorage(r),s=i?JSON.parse(i):[],o={title:a,date:e.getFormattedDate()};s.unshift(o);t.addItemToStorage(r,JSON.stringify(s))}},addNewSearchToHistoryList:function(t){if(t){var r=document.querySelector("."+a.list);if(r.length<1)this._showSearchHistory();else{var i={title:t,date:e.getFormattedDate()},s=this._formatHistoryItem(i);r.insertAdjacentHTML("afterbegin",s);this._toggleSearchResultDisplay()}}},createSearchHistoryFeed:function(){this._showSearchHistory();this._bindDeleteHistoryEvent()},_showSearchHistory:function(){for(var e=t.getLocalStorage(r),i=e?JSON.parse(e):[],s="",o=document.createElement("ul"),l=0;l<i.length;l++)s+=this._formatHistoryItem(i[l]);o.insertAdjacentHTML("beforeend",s);o.classList.add(a.list);document.querySelector(a.wrapper).appendChild(o);this._toggleSearchResultDisplay()},_deleteSearchHistory:function(){t.deleteLocalStorage(r);this._removeSearchResults();this._toggleSearchResultDisplay()},_bindDeleteHistoryEvent:function(){document.querySelector(a.deleteAll).onclick=function(){this.deleteSearchHistory()}.bind(this);document.addEventListener("click",function(e){e.target.classList.contains(a.deleteItem)&&this.deleteSearchHistoryItem(e)}.bind(this),!1)},_deleteSearchHistoryItem:function(e){var a=e.target;if(a){var i=t.getLocalStorage(r),s=i?JSON.parse(i):[],o=[];a.parentElement.remove();for(var l=0;l<s.length;l++)s[l].title!==a.dataset.title&&o.push(s[l]);t.addItemToStorage(r,JSON.stringify(o));this._toggleSearchResultDisplay()}},_removeSearchResults:function(){var e=document.querySelectorAll("."+a.list);e&&e.length>0&&e[0].remove()},_formatHistoryItem:function(e){return e?'<li>\n                            <span class="item">'.concat(e.title,'</span>\n                            <span class="date">').concat(e.date,'</span>\n                            <a class="').concat(a.deleteItem,'" href="javascript:void(0)" data-title="').concat(e.title,'"></a>\n                            </li>\n                        '):""},_toggleSearchResultDisplay:function(){var e=t.getLocalStorage(r),i=document.querySelector(a.wrapper);e&&e.length>0?i.style.display="block":i.style.display="none"}}});
"use strict";define(["utilities","storage"],function(e,t){var a="search-history",r={wrapper:".search__history",list:"search__history-list",deleteAll:"search__history-delete--all",deleteItem:"search__history-delete--item"};return{saveHistoryToStorage:function(r){if(r){var s=t.getLocalStorage(a),i=s?JSON.parse(s):[],o={title:r,date:e.getFormattedDate()};i.unshift(o);t.addItemToStorage(a,JSON.stringify(i))}},addNewSearchToHistoryList:function(t){if(t){var a=document.querySelectorAll("."+r.list);if(a&&a.length>0){var s={title:t,date:e.getFormattedDate()},i=this._formatHistoryItem(s);a[0].insertAdjacentHTML("afterbegin",i);this._toggleSearchResultDisplay()}else this._showSearchHistory()}},createSearchHistoryFeed:function(){this._showSearchHistory();this._bindDeleteHistoryEvent()},_showSearchHistory:function(){for(var e=t.getLocalStorage(a),s=e?JSON.parse(e):[],i="",o=document.createElement("ul"),l=0;l<s.length;l++)i+=this._formatHistoryItem(s[l]);o.insertAdjacentHTML("beforeend",i);o.classList.add(r.list);document.querySelector(r.wrapper).appendChild(o);this._toggleSearchResultDisplay()},_deleteSearchHistory:function(){t.deleteLocalStorage(a);this._removeSearchResults();this._toggleSearchResultDisplay()},_bindDeleteHistoryEvent:function(){document.addEventListener("click",function(e){e.target.classList.contains(r.deleteAll)&&this._deleteSearchHistory();e.target.classList.contains(r.deleteItem)&&this._deleteSearchHistoryItem(e)}.bind(this),!1)},_deleteSearchHistoryItem:function(e){var r=e.target;if(r){var s=t.getLocalStorage(a),i=s?JSON.parse(s):[],o=[];r.parentElement.remove();for(var l=0;l<i.length;l++)i[l].title!==r.dataset.title&&o.push(i[l]);t.addItemToStorage(a,JSON.stringify(o));this._toggleSearchResultDisplay()}},_removeSearchResults:function(){var e=document.querySelectorAll("."+r.list);e&&e.length>0&&e[0].remove()},_formatHistoryItem:function(e){return e?'<li>\n                            <span class="item">'.concat(e.title,'</span>\n                            <span class="date">').concat(e.date,'</span>\n                            <a class="').concat(r.deleteItem,'" href="javascript:void(0)" data-title="').concat(e.title,'"></a>\n                            </li>\n                        '):""},_toggleSearchResultDisplay:function(){var e=t.getLocalStorage(a),s=document.querySelector(r.wrapper);e&&e.length>0?s.style.display="block":s.style.display="none"}}});